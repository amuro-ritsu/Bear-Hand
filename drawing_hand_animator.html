<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawing Hand Animator - ãŠçµµã‹ãæ‰‹å…ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: transparent;
            cursor: none;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: transparent;
            pointer-events: none;
        }

        /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒ */
        #tablet {
            position: absolute;
            pointer-events: none;
            z-index: 1;
            transition: transform 0.1s ease-out;
            transform-origin: center center;
            display: none;
        }

        /* æ‰‹+ãƒšãƒ³ç”»åƒ */
        #hand {
            position: absolute;
            pointer-events: none;
            z-index: 2;
            transition: transform 0.1s ease-out;
            transform-origin: center center;
            display: none;
        }

        /* è¨­å®šãƒ‘ãƒãƒ« */
        #settings-panel {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: rgba(30, 30, 30, 0.98);
            color: #fff;
            padding: 25px;
            overflow-y: auto;
            transition: right 0.3s ease;
            z-index: 10000;
            box-shadow: -3px 0 15px rgba(0, 0, 0, 0.5);
            pointer-events: auto;
        }

        #settings-panel.open {
            right: 0;
        }

        #settings-panel::-webkit-scrollbar {
            width: 8px;
        }

        #settings-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        #settings-panel::-webkit-scrollbar-thumb {
            background: #4da6ff;
            border-radius: 4px;
        }

        #settings-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(40, 40, 40, 0.95);
            color: #fff;
            border: none;
            padding: 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            z-index: 9999;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            pointer-events: auto;
        }

        #settings-toggle:hover {
            background: rgba(60, 60, 60, 0.95);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        .panel-header {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #4da6ff;
        }

        .panel-header h2 {
            font-size: 20px;
            color: #4da6ff;
            margin-bottom: 8px;
        }

        .panel-header p {
            font-size: 13px;
            color: #999;
            line-height: 1.5;
        }

        .settings-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid #4da6ff;
        }

        .settings-section h3 {
            margin-bottom: 18px;
            font-size: 16px;
            color: #4da6ff;
            font-weight: 600;
        }

        .setting-item {
            margin-bottom: 20px;
        }

        .setting-item label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            color: #ccc;
            font-weight: 500;
        }

        .setting-item input[type="file"] {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: #fff;
            font-size: 13px;
            cursor: pointer;
        }

        .setting-item input[type="file"]::file-selector-button {
            background: #4da6ff;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            transition: background 0.2s;
        }

        .setting-item input[type="file"]::file-selector-button:hover {
            background: #3d8acc;
        }

        .setting-item input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .setting-item input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4da6ff;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: all 0.2s;
        }

        .setting-item input[type="range"]::-webkit-slider-thumb:hover {
            background: #3d8acc;
            transform: scale(1.1);
        }

        .setting-item input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4da6ff;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .setting-item input[type="number"] {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: #fff;
            font-size: 13px;
        }

        .setting-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            cursor: pointer;
            accent-color: #4da6ff;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
        }

        .checkbox-wrapper label {
            margin: 0;
            cursor: pointer;
        }

        .value-display {
            display: inline-block;
            margin-left: 12px;
            color: #4da6ff;
            font-weight: bold;
            min-width: 50px;
            font-size: 14px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider-container input[type="range"] {
            flex: 1;
        }

        .info-text {
            font-size: 12px;
            color: #888;
            line-height: 1.5;
            margin-top: 6px;
            padding: 8px 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .preview-container {
            position: relative;
            width: 100%;
            height: 180px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 6px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .preview-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .no-image-text {
            color: #666;
            font-size: 13px;
            text-align: center;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .btn {
            padding: 12px;
            background: #4da6ff;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            background: #3d8acc;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-full {
            grid-column: 1 / -1;
        }

        /* åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ */
        #initial-setup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.96);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20000;
            pointer-events: auto;
        }

        #initial-setup.hidden {
            display: none;
        }

        .setup-content {
            background: rgba(40, 40, 40, 0.98);
            padding: 50px;
            border-radius: 12px;
            max-width: 700px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .setup-content h2 {
            color: #4da6ff;
            margin-bottom: 25px;
            font-size: 28px;
        }

        .setup-content p {
            color: #ccc;
            line-height: 1.8;
            margin-bottom: 25px;
            font-size: 15px;
        }

        .setup-step {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 4px solid #4da6ff;
        }

        .setup-step h4 {
            color: #fff;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .setup-step ul {
            margin-left: 20px;
            color: #aaa;
            line-height: 1.6;
        }

        #start-animator-btn {
            width: 100%;
            padding: 18px;
            background: #4da6ff;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(77, 166, 255, 0.3);
        }

        #start-animator-btn:hover {
            background: #3d8acc;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(77, 166, 255, 0.4);
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        #status-bar {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(40, 40, 40, 0.9);
            color: #fff;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 12px;
            z-index: 9998;
            display: none;
            pointer-events: none;
        }

        #status-bar.show {
            display: block;
        }

        .status-item {
            margin: 3px 0;
        }

        .status-label {
            color: #4da6ff;
            font-weight: bold;
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .settings-section {
            animation: fadeIn 0.3s ease-out;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            #settings-panel {
                width: 100%;
                right: -100%;
            }

            .setup-content {
                padding: 30px;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ -->
    <div id="canvas-container">
        <img id="tablet" alt="Tablet">
        <img id="hand" alt="Hand with Pen">
    </div>

    <!-- è¨­å®šãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ -->
    <button id="settings-toggle">âš™ï¸ è¨­å®š</button>

    <!-- è¨­å®šãƒ‘ãƒãƒ« -->
    <div id="settings-panel">
        <div class="panel-header">
            <h2>ğŸ¨ ãŠçµµã‹ãæ‰‹å…ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <p>ãƒã‚¦ã‚¹/ãƒšãƒ³ã‚¿ãƒ–ã®å‹•ãã«é€£å‹•ã—ã¦æ‰‹å…ƒã‚’è¡¨ç¤º</p>
        </div>

        <!-- åŸºæœ¬è¨­å®š -->
        <div class="settings-section">
            <h3>ğŸ“ ç”»åƒè¨­å®š</h3>
            
            <div class="info-text" style="margin-bottom: 20px; padding: 15px; background: rgba(255, 165, 0, 0.1); border-left: 3px solid #ff9800;">
                <strong>âš ï¸ é‡è¦ï¼šOBSã§ä½¿ç”¨ã™ã‚‹å ´åˆ</strong><br>
                ã“ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ä»¥ä¸‹ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ï¼š<br>
                ãƒ»<code>hand.png</code> - æ‰‹+ãƒšãƒ³ã®ç”»åƒ<br>
                ãƒ»<code>tablet.png</code> - ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ç”»åƒ<br>
                <br>
                è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ã„ãŸã„å ´åˆã¯URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šï¼š<br>
                <code>?hand=hand2.png&tablet=tablet2.png</code>
            </div>

            <div class="setting-item">
                <label>æ‰‹+ãƒšãƒ³ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å</label>
                <input type="text" id="hand-filename" value="hand.png" 
                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); 
                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 4px; 
                              color: #fff; font-size: 13px;">
                <div class="info-text">
                    ã“ã®HTMLã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®š
                </div>
            </div>

            <div class="setting-item">
                <label>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å</label>
                <input type="text" id="tablet-filename" value="tablet.png"
                       style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); 
                              border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 4px; 
                              color: #fff; font-size: 13px;">
                <div class="info-text">
                    ã“ã®HTMLã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®š
                </div>
            </div>

            <div class="button-group">
                <button class="btn" id="reload-images">ç”»åƒã‚’å†èª­ã¿è¾¼ã¿</button>
            </div>

            <hr style="border: none; border-top: 1px solid rgba(255,255,255,0.1); margin: 20px 0;">

            <div class="setting-item">
                <label>ğŸ§ª ãƒ†ã‚¹ãƒˆç”¨ï¼šç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆOBSã§ã¯ä½¿ãˆã¾ã›ã‚“ï¼‰</label>
                <input type="file" id="hand-upload" accept="image/png,image/webp">
                <div class="preview-container" id="hand-preview">
                    <div class="no-image-text">ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ãƒ†ã‚¹ãƒˆè¡¨ç¤ºç”¨</div>
                </div>
                <div class="info-text">
                    âš ï¸ ã“ã®æ©Ÿèƒ½ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ãƒ†ã‚¹ãƒˆç”¨ã§ã™ã€‚<br>
                    OBSã§ã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚å®Ÿéš›ã®ç”»åƒã¯ãƒ•ã‚¡ã‚¤ãƒ«ã§é…ç½®ã—ã¦ãã ã•ã„ã€‚
                </div>
            </div>

            <div class="setting-item">
                <label>ğŸ§ª ãƒ†ã‚¹ãƒˆç”¨ï¼šã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆOBSã§ã¯ä½¿ãˆã¾ã›ã‚“ï¼‰</label>
                <input type="file" id="tablet-upload" accept="image/png,image/webp">
                <div class="preview-container" id="tablet-preview">
                    <div class="no-image-text">ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ãƒ†ã‚¹ãƒˆè¡¨ç¤ºç”¨</div>
                </div>
                <div class="info-text">
                    âš ï¸ ã“ã®æ©Ÿèƒ½ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ãƒ†ã‚¹ãƒˆç”¨ã§ã™ã€‚<br>
                    OBSã§ã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚å®Ÿéš›ã®ç”»åƒã¯ãƒ•ã‚¡ã‚¤ãƒ«ã§é…ç½®ã—ã¦ãã ã•ã„ã€‚
                </div>
            </div>
        </div>

        <!-- å‹•ä½œè¨­å®š -->
        <div class="settings-section">
            <h3>ğŸ® å‹•ä½œè¨­å®š</h3>
            
            <div class="setting-item">
                <label>æ„Ÿåº¦ï¼ˆã‚«ãƒ¼ã‚½ãƒ«è¿½å¾“ã®é€Ÿã•ï¼‰</label>
                <div class="slider-container">
                    <input type="range" id="sensitivity" min="0.1" max="3" step="0.1" value="1">
                    <span class="value-display" id="sensitivity-value">1.0</span>
                </div>
                <div class="info-text">
                    å°ã•ã„å€¤ï¼šã‚†ã£ãã‚Šå‹•ã / å¤§ãã„å€¤ï¼šé€Ÿãå‹•ã
                </div>
            </div>

            <div class="setting-item">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="smooth-movement" checked>
                    <label for="smooth-movement">ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ï¼ˆæ»‘ã‚‰ã‹ãªå‹•ãï¼‰</label>
                </div>
            </div>

            <div class="setting-item">
                <label>ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°å¼·åº¦</label>
                <div class="slider-container">
                    <input type="range" id="smoothness" min="0.1" max="0.9" step="0.05" value="0.3">
                    <span class="value-display" id="smoothness-value">0.30</span>
                </div>
                <div class="info-text">
                    å°ã•ã„å€¤ï¼šãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ / å¤§ãã„å€¤ï¼šãƒŒãƒ«ãƒŒãƒ«
                </div>
            </div>
        </div>

        <!-- ãƒšãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="settings-section">
            <h3>âœï¸ ãƒšãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h3>
            
            <div class="setting-item">
                <label>ãƒšãƒ³ã®å‚¾ãè§’åº¦ï¼ˆåº¦ï¼‰</label>
                <div class="slider-container">
                    <input type="range" id="tilt-angle" min="0" max="45" step="1" value="15">
                    <span class="value-display" id="tilt-angle-value">15Â°</span>
                </div>
                <div class="info-text">
                    æç”»ä¸­ã«ãƒšãƒ³ãŒå·¦å³ã«æºã‚Œã‚‹è§’åº¦ï¼ˆ0=æºã‚Œãªã—ï¼‰
                </div>
            </div>

            <div class="setting-item">
                <label>ãƒšãƒ³ã®æºã‚Œé€Ÿåº¦</label>
                <div class="slider-container">
                    <input type="range" id="tilt-speed" min="1" max="30" step="1" value="10">
                    <span class="value-display" id="tilt-speed-value">10</span>
                </div>
                <div class="info-text">
                    æºã‚Œã‚‹é€Ÿã•ï¼ˆå°ã•ã„å€¤ï¼šã‚†ã£ãã‚Š / å¤§ãã„å€¤ï¼šé€Ÿã„ï¼‰
                </div>
            </div>
        </div>

        <!-- ä½ç½®èª¿æ•´ -->
        <div class="settings-section">
            <h3>ğŸ“ ä½ç½®èª¿æ•´</h3>
            
            <div class="setting-item">
                <label>Xåº§æ¨™ã‚ªãƒ•ã‚»ãƒƒãƒˆ</label>
                <div class="slider-container">
                    <input type="range" id="offset-x" min="-500" max="500" step="10" value="0">
                    <span class="value-display" id="offset-x-value">0</span>
                </div>
            </div>

            <div class="setting-item">
                <label>Yåº§æ¨™ã‚ªãƒ•ã‚»ãƒƒãƒˆ</label>
                <div class="slider-container">
                    <input type="range" id="offset-y" min="-500" max="500" step="10" value="0">
                    <span class="value-display" id="offset-y-value">0</span>
                </div>
            </div>

            <div class="setting-item">
                <label>æ‰‹ã®ç”»åƒã‚µã‚¤ã‚º</label>
                <div class="slider-container">
                    <input type="range" id="hand-scale" min="0.3" max="3" step="0.1" value="1">
                    <span class="value-display" id="hand-scale-value">1.0x</span>
                </div>
            </div>

            <div class="setting-item">
                <label>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒã‚µã‚¤ã‚º</label>
                <div class="slider-container">
                    <input type="range" id="tablet-scale" min="0.3" max="3" step="0.1" value="1">
                    <span class="value-display" id="tablet-scale-value">1.0x</span>
                </div>
            </div>

            <div class="setting-item">
                <label>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ç¸¦ä½ç½®ã‚ªãƒ•ã‚»ãƒƒãƒˆ</label>
                <div class="slider-container">
                    <input type="range" id="tablet-offset-y" min="-200" max="200" step="10" value="50">
                    <span class="value-display" id="tablet-offset-y-value">50</span>
                </div>
                <div class="info-text">
                    æ‰‹ã¨ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ä¸Šä¸‹ä½ç½®é–¢ä¿‚ã‚’èª¿æ•´
                </div>
            </div>
        </div>

        <!-- ç”»é¢ç«¯åˆ¶é™ -->
        <div class="settings-section">
            <h3>ğŸ”² ç”»é¢ç«¯åˆ¶é™</h3>
            
            <div class="setting-item">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="enable-limits">
                    <label for="enable-limits">ç”»é¢ç«¯åˆ¶é™ã‚’æœ‰åŠ¹åŒ–</label>
                </div>
                <div class="info-text">
                    æ‰‹ã‚„ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãŒç”»é¢ã‹ã‚‰ã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã«åˆ¶é™
                </div>
            </div>

            <div class="setting-item">
                <label>å·¦ç«¯ã®åˆ¶é™ (Xåº§æ¨™ã®æœ€å°å€¤)</label>
                <div class="slider-container">
                    <input type="range" id="limit-left" min="0" max="960" step="10" value="0">
                    <span class="value-display" id="limit-left-value">0</span>
                </div>
            </div>

            <div class="setting-item">
                <label>å³ç«¯ã®åˆ¶é™ (Xåº§æ¨™ã®æœ€å¤§å€¤)</label>
                <div class="slider-container">
                    <input type="range" id="limit-right" min="960" max="1920" step="10" value="1920">
                    <span class="value-display" id="limit-right-value">1920</span>
                </div>
            </div>

            <div class="setting-item">
                <label>ä¸Šç«¯ã®åˆ¶é™ (Yåº§æ¨™ã®æœ€å°å€¤)</label>
                <div class="slider-container">
                    <input type="range" id="limit-top" min="0" max="540" step="10" value="0">
                    <span class="value-display" id="limit-top-value">0</span>
                </div>
            </div>

            <div class="setting-item">
                <label>ä¸‹ç«¯ã®åˆ¶é™ (Yåº§æ¨™ã®æœ€å¤§å€¤)</label>
                <div class="slider-container">
                    <input type="range" id="limit-bottom" min="540" max="1080" step="10" value="1080">
                    <span class="value-display" id="limit-bottom-value">1080</span>
                </div>
            </div>

            <div class="info-text">
                ğŸ’¡ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆ1920Ã—1080ï¼‰ã‹ã‚‰èª¿æ•´ã—ã¦ãã ã•ã„ã€‚<br>
                è¤‡æ•°ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚„ç‰¹æ®Šãªè§£åƒåº¦ã®å ´åˆã¯æ‰‹å‹•ã§èª¿æ•´ãŒå¿…è¦ã§ã™ã€‚
            </div>
        </div>

        <!-- è¡¨ç¤ºè¨­å®š -->
        <div class="settings-section">
            <h3>ğŸ‘ï¸ è¡¨ç¤ºè¨­å®š</h3>
            
            <div class="setting-item">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="show-hand" checked>
                    <label for="show-hand">æ‰‹ã‚’è¡¨ç¤º</label>
                </div>
            </div>

            <div class="setting-item">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="show-tablet" checked>
                    <label for="show-tablet">ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã‚’è¡¨ç¤º</label>
                </div>
            </div>

            <div class="setting-item">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="show-status" checked>
                    <label for="show-status">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰</label>
                </div>
            </div>
        </div>

        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="settings-section">
            <h3>ğŸ’¾ è¨­å®šç®¡ç†</h3>
            
            <div class="button-group">
                <button class="btn btn-full" id="save-settings">è¨­å®šã‚’ä¿å­˜</button>
                <button class="btn btn-secondary" id="reset-settings">ãƒªã‚»ãƒƒãƒˆ</button>
                <button class="btn btn-secondary" id="clear-images">ç”»åƒã‚’ã‚¯ãƒªã‚¢</button>
            </div>
        </div>

        <!-- æƒ…å ± -->
        <div class="settings-section">
            <h3>â„¹ï¸ æƒ…å ±</h3>
            <div class="info-text">
                <strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</strong> 1.0.0<br>
                <strong>å¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶:</strong> Chrome, Edge, Firefox<br>
                <strong>æ¨å¥¨è§£åƒåº¦:</strong> 1920Ã—1080ä»¥ä¸Š<br>
                <br>
                <strong>ä½¿ã„æ–¹:</strong><br>
                1. æ‰‹ã¨ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰<br>
                2. OBSã§ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã€ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ <br>
                3. ã€Œã‚«ã‚¹ã‚¿ãƒ CSSã€ã§èƒŒæ™¯ã‚’é€é<br>
                <code>body { background-color: rgba(0, 0, 0, 0); }</code>
            </div>
        </div>
    </div>

    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ -->
    <div id="status-bar">
        <div class="status-item">
            <span class="status-label">ãƒã‚¦ã‚¹:</span>
            <span id="status-mouse">-</span>
        </div>
        <div class="status-item">
            <span class="status-label">æç”»ä¸­:</span>
            <span id="status-drawing">-</span>
        </div>
        <div class="status-item">
            <span class="status-label">å›è»¢:</span>
            <span id="status-rotation">-</span>
        </div>
    </div>

    <!-- åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— -->
    <div id="initial-setup">
        <div class="setup-content">
            <h2>ğŸ¨ ãŠçµµã‹ãæ‰‹å…ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <p>
                ãŠçµµã‹ãé…ä¿¡ã§æ‰‹å…ƒã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚<br>
                ãƒã‚¦ã‚¹/ãƒšãƒ³ã‚¿ãƒ–ã®å‹•ãã«é€£å‹•ã—ã¦ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ‰‹å…ƒãŒå‹•ãã¾ã™ã€‚
            </p>

            <div class="setup-step">
                <h4>ğŸ“ ä½¿ã„æ–¹</h4>
                <ul>
                    <li>å³ä¸Šã®ã€Œâš™ï¸ è¨­å®šã€ãƒœã‚¿ãƒ³ã‹ã‚‰ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
                    <li>ãƒšãƒ³ã‚’æŒã£ãŸæ‰‹ã®ç”»åƒï¼ˆé€éPNGï¼‰</li>
                    <li>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆèƒŒé¢ã®ç”»åƒï¼ˆé€éPNGï¼‰</li>
                    <li>å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã—ã¦å®Œæˆï¼</li>
                </ul>
            </div>

            <div class="setup-step">
                <h4>ğŸ¬ OBSã§ã®ä½¿ç”¨æ–¹æ³•</h4>
                <ul>
                    <li>OBSã§ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã€ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ </li>
                    <li>ã“ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®š</li>
                    <li>å¹…: 1920, é«˜ã•: 1080ï¼ˆæ¨å¥¨ï¼‰</li>
                    <li>ã€Œã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³æ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ›´æ–°ã€ã‚’ON</li>
                </ul>
            </div>

            <button id="start-animator-btn">é–‹å§‹ã™ã‚‹</button>
        </div>
    </div>

    <script>
        // ================== è¨­å®šç®¡ç† ==================
        const DEFAULT_SETTINGS = {
            sensitivity: 1.0,
            smoothMovement: true,
            smoothness: 0.3,
            tiltAngle: 15,
            tiltSpeed: 10,
            offsetX: 0,
            offsetY: 0,
            handScale: 1.0,
            tabletScale: 1.0,
            tabletOffsetY: 50,
            showHand: true,
            showTablet: true,
            showStatus: false,
            // ç”»é¢ç«¯åˆ¶é™
            limitLeft: 0,
            limitRight: 1920,
            limitTop: 0,
            limitBottom: 1080,
            enableLimits: false
        };

        let settings = { ...DEFAULT_SETTINGS };

        // ================== çŠ¶æ…‹ç®¡ç† ==================
        const state = {
            mouseX: 0,
            mouseY: 0,
            targetX: 0,
            targetY: 0,
            currentX: 0,
            currentY: 0,
            isDrawing: false,
            currentRotation: 0,
            targetRotation: 0,
            frameCount: 0,
            handImage: null,
            tabletImage: null
        };

        // ================== DOMè¦ç´  ==================
        const elements = {
            hand: document.getElementById('hand'),
            tablet: document.getElementById('tablet'),
            settingsPanel: document.getElementById('settings-panel'),
            settingsToggle: document.getElementById('settings-toggle'),
            initialSetup: document.getElementById('initial-setup'),
            statusBar: document.getElementById('status-bar'),
            
            // è¨­å®šå…¥åŠ›
            handFilename: document.getElementById('hand-filename'),
            tabletFilename: document.getElementById('tablet-filename'),
            reloadImages: document.getElementById('reload-images'),
            handUpload: document.getElementById('hand-upload'),
            tabletUpload: document.getElementById('tablet-upload'),
            sensitivity: document.getElementById('sensitivity'),
            smoothMovement: document.getElementById('smooth-movement'),
            smoothness: document.getElementById('smoothness'),
            tiltAngle: document.getElementById('tilt-angle'),
            tiltSpeed: document.getElementById('tilt-speed'),
            offsetX: document.getElementById('offset-x'),
            offsetY: document.getElementById('offset-y'),
            handScale: document.getElementById('hand-scale'),
            tabletScale: document.getElementById('tablet-scale'),
            tabletOffsetY: document.getElementById('tablet-offset-y'),
            showHand: document.getElementById('show-hand'),
            showTablet: document.getElementById('show-tablet'),
            showStatus: document.getElementById('show-status'),
            enableLimits: document.getElementById('enable-limits'),
            limitLeft: document.getElementById('limit-left'),
            limitRight: document.getElementById('limit-right'),
            limitTop: document.getElementById('limit-top'),
            limitBottom: document.getElementById('limit-bottom'),
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
            handPreview: document.getElementById('hand-preview'),
            tabletPreview: document.getElementById('tablet-preview'),
            
            // ãƒœã‚¿ãƒ³
            saveSettings: document.getElementById('save-settings'),
            resetSettings: document.getElementById('reset-settings'),
            clearImages: document.getElementById('clear-images'),
            startAnimatorBtn: document.getElementById('start-animator-btn')
        };

        // ================== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ==================
        function lerp(a, b, t) {
            return a + (b - a) * t;
        }

        function saveToLocalStorage() {
            try {
                localStorage.setItem('drawingHandSettings', JSON.stringify(settings));
                if (state.handImage) {
                    localStorage.setItem('drawingHandImage', state.handImage);
                }
                if (state.tabletImage) {
                    localStorage.setItem('drawingTabletImage', state.tabletImage);
                }
                showNotification('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            } catch (e) {
                console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
                showNotification('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedSettings = localStorage.getItem('drawingHandSettings');
                if (savedSettings) {
                    settings = { ...DEFAULT_SETTINGS, ...JSON.parse(savedSettings) };
                }
                
                const savedHandImage = localStorage.getItem('drawingHandImage');
                if (savedHandImage) {
                    state.handImage = savedHandImage;
                    elements.hand.src = savedHandImage;
                    elements.hand.style.display = 'block';
                    updatePreview('hand', savedHandImage);
                }
                
                const savedTabletImage = localStorage.getItem('drawingTabletImage');
                if (savedTabletImage) {
                    state.tabletImage = savedTabletImage;
                    elements.tablet.src = savedTabletImage;
                    elements.tablet.style.display = 'block';
                    updatePreview('tablet', savedTabletImage);
                }
                
                updateUIFromSettings();
            } catch (e) {
                console.error('èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
            }
        }

        function updateUIFromSettings() {
            elements.sensitivity.value = settings.sensitivity;
            elements.smoothMovement.checked = settings.smoothMovement;
            elements.smoothness.value = settings.smoothness;
            elements.tiltAngle.value = settings.tiltAngle;
            elements.tiltSpeed.value = settings.tiltSpeed;
            elements.offsetX.value = settings.offsetX;
            elements.offsetY.value = settings.offsetY;
            elements.handScale.value = settings.handScale;
            elements.tabletScale.value = settings.tabletScale;
            elements.tabletOffsetY.value = settings.tabletOffsetY;
            elements.showHand.checked = settings.showHand;
            elements.showTablet.checked = settings.showTablet;
            elements.showStatus.checked = settings.showStatus;
            elements.enableLimits.checked = settings.enableLimits;
            elements.limitLeft.value = settings.limitLeft;
            elements.limitRight.value = settings.limitRight;
            elements.limitTop.value = settings.limitTop;
            elements.limitBottom.value = settings.limitBottom;
            
            updateValueDisplays();
            updateVisibility();
        }

        function updateValueDisplays() {
            document.getElementById('sensitivity-value').textContent = settings.sensitivity.toFixed(1);
            document.getElementById('smoothness-value').textContent = settings.smoothness.toFixed(2);
            document.getElementById('tilt-angle-value').textContent = settings.tiltAngle + 'Â°';
            document.getElementById('tilt-speed-value').textContent = settings.tiltSpeed;
            document.getElementById('offset-x-value').textContent = settings.offsetX;
            document.getElementById('offset-y-value').textContent = settings.offsetY;
            document.getElementById('hand-scale-value').textContent = settings.handScale.toFixed(1) + 'x';
            document.getElementById('tablet-scale-value').textContent = settings.tabletScale.toFixed(1) + 'x';
            document.getElementById('tablet-offset-y-value').textContent = settings.tabletOffsetY;
            document.getElementById('limit-left-value').textContent = settings.limitLeft;
            document.getElementById('limit-right-value').textContent = settings.limitRight;
            document.getElementById('limit-top-value').textContent = settings.limitTop;
            document.getElementById('limit-bottom-value').textContent = settings.limitBottom;
        }

        function updatePreview(type, dataUrl) {
            const previewContainer = type === 'hand' ? elements.handPreview : elements.tabletPreview;
            previewContainer.innerHTML = `<img src="${dataUrl}" class="preview-image" alt="${type} preview">`;
        }

        function updateVisibility() {
            elements.hand.style.display = settings.showHand && state.handImage ? 'block' : 'none';
            elements.tablet.style.display = settings.showTablet && state.tabletImage ? 'block' : 'none';
            elements.statusBar.classList.toggle('show', settings.showStatus);
        }

        function showNotification(message, type = 'success') {
            // ç°¡æ˜“é€šçŸ¥ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ« + å°†æ¥çš„ã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚‚å¯èƒ½ï¼‰
            const prefix = type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'âœ…';
            console.log(`${prefix} ${message}`);
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã«ä¸€æ™‚è¡¨ç¤º
            if (elements.statusBar) {
                const statusText = elements.statusBar.querySelector('.status-item');
                if (statusText) {
                    const originalText = statusText.innerHTML;
                    statusText.innerHTML = `<span class="status-label">${prefix}</span> ${message}`;
                    setTimeout(() => {
                        statusText.innerHTML = originalText;
                    }, 3000);
                }
            }
        }

        // ================== è¨­å®šä¿å­˜ï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆå¯¾å¿œï¼‰ ==================
        function saveToLocalStorage() {
            const urlParams = getUrlParams();
            const storageKey = urlParams.preset ? `drawingHandPreset_${urlParams.preset}` : 'drawingHandSettings';
            
            try {
                localStorage.setItem(storageKey, JSON.stringify(settings));
                showNotification('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            } catch (e) {
                console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
                showNotification('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        function loadFromLocalStorage() {
            const urlParams = getUrlParams();
            const storageKey = urlParams.preset ? `drawingHandPreset_${urlParams.preset}` : 'drawingHandSettings';
            
            try {
                const savedSettings = localStorage.getItem(storageKey);
                if (savedSettings) {
                    settings = { ...DEFAULT_SETTINGS, ...JSON.parse(savedSettings) };
                }
            } catch (e) {
                console.error('èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
            }
        }ç°¡æ˜“é€šçŸ¥ï¼ˆå°†æ¥çš„ã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’å®Ÿè£…å¯èƒ½ï¼‰
            console.log(`[${type}] ${message}`);
        }

        // ================== ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ==================
        function handleImageUpload(type, file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const dataUrl = e.target.result;
                
                if (type === 'hand') {
                    state.handImage = dataUrl;
                    elements.hand.src = dataUrl;
                    elements.hand.style.display = 'block';
                    updatePreview('hand', dataUrl);
                } else {
                    state.tabletImage = dataUrl;
                    elements.tablet.src = dataUrl;
                    elements.tablet.style.display = 'block';
                    updatePreview('tablet', dataUrl);
                }
                
                updateVisibility();
            };
            reader.readAsDataURL(file);
        }

        // ================== ãƒã‚¦ã‚¹è¿½è·¡ ==================
        document.addEventListener('mousemove', (e) => {
            state.mouseX = e.clientX;
            state.mouseY = e.clientY;
        });

        document.addEventListener('mousedown', () => {
            state.isDrawing = true;
        });

        document.addEventListener('mouseup', () => {
            state.isDrawing = false;
        });

        // ================== ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ— ==================
        function updateAnimation() {
            // åŸºæœ¬ã‚¿ãƒ¼ã‚²ãƒƒãƒˆä½ç½®ã‚’è¨ˆç®—
            const baseTargetX = state.mouseX * settings.sensitivity + settings.offsetX;
            const baseTargetY = state.mouseY * settings.sensitivity + settings.offsetY;
            
            // ãƒšãƒ³ã®å††é‹å‹•ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæç”»ä¸­ã®ã¿ï¼‰
            let circleOffsetX = 0;
            let circleOffsetY = 0;
            let targetRotation = 0;
            
            if (state.isDrawing && settings.tiltAngle > 0) {
                state.frameCount += settings.tiltSpeed * 0.1;
                
                // å††é‹å‹•ã®è¨ˆç®—ï¼ˆãƒšãƒ³å…ˆã‚’ä¸­å¿ƒã«æ‰‹ãŒå††ã‚’æãï¼‰
                const angle = state.frameCount;
                const radius = settings.tiltAngle * 0.8; // è§’åº¦ã‹ã‚‰åŠå¾„ã‚’è¨ˆç®—
                
                // ãƒšãƒ³å…ˆã‚’å›ºå®šã™ã‚‹ãŸã‚ã€æ‰‹ã®ä½ç½®ã‚’ãšã‚‰ã™
                circleOffsetX = Math.sin(angle) * radius;
                circleOffsetY = Math.cos(angle) * radius * 0.5; // Yæ–¹å‘ã¯æ§ãˆã‚ã«
                
                // æ‰‹ã®ä½ç½®ã«å¿œã˜ã¦ãƒšãƒ³ã®è§’åº¦ã‚‚å¤‰ãˆã‚‹
                targetRotation = Math.sin(angle) * settings.tiltAngle;
            }
            
            // å††é‹å‹•ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’åŠ ãˆãŸã‚¿ãƒ¼ã‚²ãƒƒãƒˆä½ç½®
            state.targetX = baseTargetX + circleOffsetX;
            state.targetY = baseTargetY + circleOffsetY;
            
            // ç”»é¢ç«¯åˆ¶é™ã‚’é©ç”¨
            if (settings.enableLimits) {
                state.targetX = Math.max(settings.limitLeft, Math.min(settings.limitRight, state.targetX));
                state.targetY = Math.max(settings.limitTop, Math.min(settings.limitBottom, state.targetY));
            }
            
            // ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°å‡¦ç†
            if (settings.smoothMovement) {
                state.currentX = lerp(state.currentX, state.targetX, settings.smoothness);
                state.currentY = lerp(state.currentY, state.targetY, settings.smoothness);
            } else {
                state.currentX = state.targetX;
                state.currentY = state.targetY;
            }
            
            // å›è»¢ã®ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°
            state.currentRotation = lerp(state.currentRotation, targetRotation, 0.2);
            
            // æ‰‹ã®ä½ç½®ã¨å›è»¢ã‚’æ›´æ–°
            if (state.handImage && settings.showHand) {
                const handTransform = `translate(-50%, -50%) translate(${state.currentX}px, ${state.currentY}px) rotate(${state.currentRotation}deg) scale(${settings.handScale})`;
                elements.hand.style.transform = handTransform;
                elements.hand.style.left = '0';
                elements.hand.style.top = '0';
            }
            
            // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®ä½ç½®ã‚’æ›´æ–°ï¼ˆå›è»¢ãªã—ã€æ‰‹ã‚ˆã‚Šä¸‹ï¼‰
            if (state.tabletImage && settings.showTablet) {
                const tabletTransform = `translate(-50%, -50%) translate(${state.currentX}px, ${state.currentY + settings.tabletOffsetY}px) scale(${settings.tabletScale})`;
                elements.tablet.style.transform = tabletTransform;
                elements.tablet.style.left = '0';
                elements.tablet.style.top = '0';
            }
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
            if (settings.showStatus) {
                document.getElementById('status-mouse').textContent = `${Math.round(state.mouseX)}, ${Math.round(state.mouseY)}`;
                document.getElementById('status-drawing').textContent = state.isDrawing ? 'æç”»ä¸­' : 'å¾…æ©Ÿä¸­';
                document.getElementById('status-rotation').textContent = `${state.currentRotation.toFixed(1)}Â°`;
            }
            
            requestAnimationFrame(updateAnimation);
        }

        // ================== ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ==================
        elements.settingsToggle.addEventListener('click', () => {
            elements.settingsPanel.classList.toggle('open');
        });

        elements.startAnimatorBtn.addEventListener('click', () => {
            elements.initialSetup.classList.add('hidden');
            updateAnimation();
        });

        // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã¨å†èª­ã¿è¾¼ã¿
        elements.reloadImages.addEventListener('click', () => {
            loadImages();
        });

        elements.handUpload.addEventListener('change', (e) => {
            handleImageUpload('hand', e.target.files[0]);
        });

        elements.tabletUpload.addEventListener('change', (e) => {
            handleImageUpload('tablet', e.target.files[0]);
        });

        // è¨­å®šå¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
        elements.sensitivity.addEventListener('input', (e) => {
            settings.sensitivity = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.smoothMovement.addEventListener('change', (e) => {
            settings.smoothMovement = e.target.checked;
        });

        elements.smoothness.addEventListener('input', (e) => {
            settings.smoothness = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.tiltAngle.addEventListener('input', (e) => {
            settings.tiltAngle = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.tiltSpeed.addEventListener('input', (e) => {
            settings.tiltSpeed = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.offsetX.addEventListener('input', (e) => {
            settings.offsetX = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.offsetY.addEventListener('input', (e) => {
            settings.offsetY = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.handScale.addEventListener('input', (e) => {
            settings.handScale = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.tabletScale.addEventListener('input', (e) => {
            settings.tabletScale = parseFloat(e.target.value);
            updateValueDisplays();
        });

        elements.tabletOffsetY.addEventListener('input', (e) => {
            settings.tabletOffsetY = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.showHand.addEventListener('change', (e) => {
            settings.showHand = e.target.checked;
            updateVisibility();
        });

        elements.showTablet.addEventListener('change', (e) => {
            settings.showTablet = e.target.checked;
            updateVisibility();
        });

        elements.showStatus.addEventListener('change', (e) => {
            settings.showStatus = e.target.checked;
            updateVisibility();
        });

        elements.enableLimits.addEventListener('change', (e) => {
            settings.enableLimits = e.target.checked;
        });

        elements.limitLeft.addEventListener('input', (e) => {
            settings.limitLeft = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.limitRight.addEventListener('input', (e) => {
            settings.limitRight = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.limitTop.addEventListener('input', (e) => {
            settings.limitTop = parseInt(e.target.value);
            updateValueDisplays();
        });

        elements.limitBottom.addEventListener('input', (e) => {
            settings.limitBottom = parseInt(e.target.value);
            updateValueDisplays();
        });

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
        elements.saveSettings.addEventListener('click', () => {
            saveToLocalStorage();
        });

        elements.resetSettings.addEventListener('click', () => {
            if (confirm('è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿï¼ˆç”»åƒã¯ä¿æŒã•ã‚Œã¾ã™ï¼‰')) {
                settings = { ...DEFAULT_SETTINGS };
                updateUIFromSettings();
                saveToLocalStorage();
                showNotification('è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
            }
        });

        elements.clearImages.addEventListener('click', () => {
            if (confirm('ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                state.handImage = null;
                state.tabletImage = null;
                elements.hand.src = '';
                elements.tablet.src = '';
                elements.hand.style.display = 'none';
                elements.tablet.style.display = 'none';
                elements.handPreview.innerHTML = '<div class="no-image-text">ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„</div>';
                elements.tabletPreview.innerHTML = '<div class="no-image-text">ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„</div>';
                localStorage.removeItem('drawingHandImage');
                localStorage.removeItem('drawingTabletImage');
                showNotification('ç”»åƒã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
        });

        // ================== URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾— ==================
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                hand: params.get('hand') || null,
                tablet: params.get('tablet') || null,
                preset: params.get('preset') || null
            };
        }

        // ================== ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã®å–å¾— ==================
        function getImageFilenames() {
            const urlParams = getUrlParams();
            return {
                hand: urlParams.hand || elements.handFilename.value || 'hand.png',
                tablet: urlParams.tablet || elements.tabletFilename.value || 'tablet.png'
            };
        }

        // ================== ç”»åƒã®èª­ã¿è¾¼ã¿ ==================
        function loadImages() {
            const filenames = getImageFilenames();
            
            // æ‰‹ã®ç”»åƒã‚’èª­ã¿è¾¼ã¿
            const handImg = new Image();
            handImg.onload = () => {
                elements.hand.src = filenames.hand;
                elements.hand.style.display = 'block';
                state.handImage = filenames.hand;
                console.log('âœ… æ‰‹ã®ç”»åƒã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', filenames.hand);
                showNotification('æ‰‹ã®ç”»åƒã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            };
            handImg.onerror = () => {
                console.error('âŒ æ‰‹ã®ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“:', filenames.hand);
                elements.hand.style.display = 'none';
                showNotification(`æ‰‹ã®ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${filenames.hand}`, 'error');
            };
            handImg.src = filenames.hand;
            
            // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒã‚’èª­ã¿è¾¼ã¿
            const tabletImg = new Image();
            tabletImg.onload = () => {
                elements.tablet.src = filenames.tablet;
                elements.tablet.style.display = 'block';
                state.tabletImage = filenames.tablet;
                console.log('âœ… ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', filenames.tablet);
                showNotification('ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            };
            tabletImg.onerror = () => {
                console.error('âŒ ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“:', filenames.tablet);
                elements.tablet.style.display = 'none';
                showNotification(`ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${filenames.tablet}`, 'error');
            };
            tabletImg.src = filenames.tablet;
            
            updateVisibility();
        }

        // ================== ãƒ—ãƒªã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ ==================
        function loadPresetSettings() {
            const urlParams = getUrlParams();
            if (!urlParams.preset) return;
            
            // ãƒ—ãƒªã‚»ãƒƒãƒˆåã‚’LocalStorageã®ã‚­ãƒ¼ã¨ã—ã¦ä½¿ç”¨
            const presetKey = `drawingHandPreset_${urlParams.preset}`;
            try {
                const savedSettings = localStorage.getItem(presetKey);
                if (savedSettings) {
                    settings = { ...DEFAULT_SETTINGS, ...JSON.parse(savedSettings) };
                    console.log('âœ… ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', urlParams.preset);
                }
            } catch (e) {
                console.error('âŒ ãƒ—ãƒªã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
            }
        }

        // ================== ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰ ==================
        function handleImageUpload(type, file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const dataUrl = e.target.result;
                
                if (type === 'hand') {
                    elements.hand.src = dataUrl;
                    elements.hand.style.display = 'block';
                    state.handImage = dataUrl;
                    updatePreview('hand', dataUrl);
                } else {
                    elements.tablet.src = dataUrl;
                    elements.tablet.style.display = 'block';
                    state.tabletImage = dataUrl;
                    updatePreview('tablet', dataUrl);
                }
                
                updateVisibility();
                showNotification(`${type === 'hand' ? 'æ‰‹' : 'ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ'}ã®ç”»åƒã‚’ãƒ†ã‚¹ãƒˆè¡¨ç¤ºã—ã¾ã—ãŸï¼ˆOBSã§ã¯ä½¿ãˆã¾ã›ã‚“ï¼‰`, 'warning');
            };
            reader.readAsDataURL(file);
        }

        function updatePreview(type, dataUrl) {
            const previewContainer = type === 'hand' ? elements.handPreview : elements.tabletPreview;
            previewContainer.innerHTML = `<img src="${dataUrl}" class="preview-image" alt="${type} preview">`;
        }
        // ================== åˆæœŸåŒ– ==================
        window.addEventListener('load', () => {
            loadPresetSettings();
            loadFromLocalStorage();
            updateUIFromSettings();
            loadImages();
        });

        // OBSãƒ–ãƒ©ã‚¦ã‚¶ã‚½ãƒ¼ã‚¹ç”¨ã®è‡ªå‹•é–‹å§‹
        if (window.obsstudio) {
            elements.initialSetup.classList.add('hidden');
            updateAnimation();
        }
    </script>
</body>
</html>
